<div>
  <!-- 数据列表展示部分 -->
  <nz-card class="table-list" [nzBordered]="false" [nzTitle]="title" [nzExtra]="tableToolbar">
    <nz-table
      #table
      [nzData]="listData.records"
      nzShowPagination
      nzOuterBordered
      [nzLoading]="loading"
      nzTableLayout="fixed"
      [nzFrontPagination]="false"
      [nzLoadingDelay]="loadingDelay"
      [nzTotal]="listData.total"
      [nzPageSize]="listData.pageSize"
      [nzPageIndex]="listData.current"
      [nzShowTotal]="pageTotalInfo"
      [nzSize]="tableSize"
    >
      <!--标题展示-->
      <thead>
        <tr>
          <!--checkbox列-->
          <th
            nzShowCheckbox
            nzWidth="4rem"
            *ngIf="showCheckboxColum"
            [nzIndeterminate]="allCheckedIndeterminate"
            nzLeft
            [nzChecked]="allChecked"
            (nzCheckedChange)="allCheckedChange($event)"
          ></th>

          <!--业务列-->
          <th
            *ngFor="let item of columnKeyValueMap"
            nzAlign="center"
            [nzWidth]="!item.width ? null : item.width + 'px'"
            [nzShowSort]="item.showSort"
            [nzSortOrder]="item.sortOrder ? item.sortOrder : null"
            [nzSortFn]="item.sortFn ? item.sortFn : null"
            nz-resizable
            nzPreview
            [nzMaxWidth]="1200"
            [nzMinWidth]="80"
          >
            {{ item.name }}
          </th>

          <!--操作列-->
          <th *ngIf="commendColum" nzAlign="center">操作</th>
        </tr>
      </thead>

      <!-- 数据展示 -->
      <tbody>
        <tr *ngFor="let data of table.data">
          <!--checkbox列-->
          <td
            nzShowCheckbox
            *ngIf="showCheckboxColum"
            nzEllipsis
            nzLeft
            [nzChecked]="data['_checked']"
            (nzCheckedChange)="itemCheckedChange($event, data)"
          ></td>

          <!--业务列-->
          <td
            [nzAlign]="item.align ? item.align : 'center'"
            *ngFor="let item of columnKeyValueMap"
            [nzEllipsis]="item.ellipsis ? item.ellipsis : false"
          >
            {{ getColumnValue(item, data) }}
          </td>

          <!--操作列-->
          <td *ngIf="commendColum" nzAlign="center">
            <ng-container *ngTemplateOutlet="commendColum; context: { $implicit: data }"></ng-container>
          </td>
        </tr>
      </tbody>
    </nz-table>
  </nz-card>

  <!--展示分页总数信息-->
  <ng-template #pageTotalInfo let-total let-range="range">
    第 {{ range[0] }}-{{ range[1] }} 条/总共 {{ total }} 条
  </ng-template>

  <!--工具栏汇总-->
  <ng-template #tableToolbar>
    <div class="toolbar">
      <nz-space nzSize="middle">
        <!--新增按钮-->
        <ng-container *ngIf="addForm">
          <button *nzSpaceItem nz-button nzType="primary"><i nz-icon nzType="plus"></i>新增</button>
        </ng-container>

        <!--修改按钮-->
        <ng-container *ngIf="editForm">
          <button *nzSpaceItem nz-button nzType="default"><i nz-icon nzType="edit"></i>修改</button>
        </ng-container>

        <!--删除按钮-->
        <ng-container *ngIf="showCheckboxColum">
          <button *nzSpaceItem nz-button nzType="default" nzDanger><i nz-icon nzType="delete"></i>删除</button>
        </ng-container>
      </nz-space>

      <nz-divider nzType="vertical" *ngIf="addForm || editForm || showCheckboxColum"></nz-divider>

      <!--图标按钮-->
      <nz-space nzSize="middle">
        <i
          class="hand-model hover-color"
          *nzSpaceItem
          nz-icon
          nzType="reload"
          [nzSpin]="loading"
          nzTheme="outline"
          nz-tooltip
          nzTooltipTitle="刷新"
          (click)="refresh()"
        ></i>
        <i
          class="hand-model hover-color"
          *nzSpaceItem
          nz-icon
          nzType="column-height"
          nzTheme="outline"
          nzTrigger="click"
          nz-tooltip
          nzTooltipTitle="密度"
          nz-dropdown
          [nzDropdownMenu]="tableSizeMenu"
          nzPlacement="bottomCenter"
        ></i>
        <i
          class="hand-model hover-color"
          *nzSpaceItem
          nz-icon
          nzType="setting"
          nzTheme="outline"
          nz-tooltip
          nzTooltipTitle="列设置"
          nz-popover
          nzPopoverTrigger="click"
          [nzPopoverContent]="columSettingContentTemplate"
          [nzPopoverTitle]="columSettingTitleTemplate"
          nzPopoverPlacement="bottomRight"
        ></i>
      </nz-space>
    </div>
  </ng-template>
</div>

<!--列表密度插槽-->
<nz-dropdown-menu #tableSizeMenu>
  <ul nz-menu>
    <li
      nz-menu-item
      (click)="changeTableSize(item.value)"
      [nzSelected]="item.selected"
      *ngFor="let item of tableSizeProps"
    >
      <span>{{ item.name }}</span>
    </li>
  </ul>
</nz-dropdown-menu>

<!--列设置弹出气泡标题模板-->
<ng-template #columSettingTitleTemplate>
  <div class="space-between">
    <nz-space>
      <label nz-checkbox *nzSpaceItem>勾选列</label>
      <label nz-checkbox *nzSpaceItem>列展示</label>
    </nz-space>

    <button class="operate-text" nz-button nzType="text">重置</button>
  </div>
</ng-template>

<!--列设置弹出气泡内容模板-->
<ng-template #columSettingContentTemplate>
  <div style="min-width: 31.5rem">内容</div>
</ng-template>
